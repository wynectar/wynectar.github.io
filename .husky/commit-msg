#!/bin/bash

# Get commit message file path
COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Process commit message with awk
awk '
BEGIN {
  # Define emoji mapping
  emojis["feat"] = "ðŸš€"
  emojis["fix"] = "ðŸ›"
  emojis["docs"] = "ðŸ“š"
  emojis["style"] = "ðŸŽ¨"
  emojis["refactor"] = "â™»ï¸"
  emojis["perf"] = "âš¡ï¸"
  emojis["test"] = "ðŸ§ª"
  emojis["build"] = "ðŸ“¦"
  emojis["ci"] = "ðŸ‘·"
  emojis["chore"] = "ðŸ”§"
  emojis["revert"] = "âª"
}
{
  # Match conventional commit format
  if ($0 ~ /^[a-z]+(\([^)]*\))?:/) {
    split($0, parts, /[:\(\)]/)
    type = parts[1]
    if (type in emojis) {
      # Insert emoji after type
      sub(/^[a-z]+/, "&" emojis[type])
    }
  }
  print $0
}' "$COMMIT_MSG_FILE" > "$COMMIT_MSG_FILE.tmp"

# Replace original commit message
mv "$COMMIT_MSG_FILE.tmp" "$COMMIT_MSG_FILE"